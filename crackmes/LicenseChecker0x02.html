<!DOCTYPE html>
<html>
<head>
<style>
  body {background-color: #121212;
        color: white;}
  h1 { text-align: center; }
  #code_1 { border: 2px solid white; width: 50%; margin: auto; padding: 2px;text-align: center;}
  #code_2 { border: 2px solid red; }
  .source { border: 2px solid white; width: 50%; margin: auto; padding: 4px; text-align: center;}
 


</style>
<body>
  <h1>NomanProdhan's License Checker 0x02</h1><br>
  <p>So first things first, we will run the file to get an idea about what the underlying code will look like,
     in this case the program takes two commandline arguments, a name, and the key. We also want to get an 
    idea about the control flow, and the idea here is that if we have provided the name, and the key, 
    and the key is valid, output a success message, and if not, output an error message.
    Now we can load this into a debugger, I will be using <i>gdb</i>, I'll use the 
    <strong>info <i>functions</i></strong> command to print a list of functions within the binary, 
    This output allows me to see that the binary is a c/c++ file, based on the functions that it has.
    Since c files entry point is the <i>main()</i> function, I'll run <strong>disas <i>main</i></strong> 
    to output the code associated with the <i>main()</i> function. I should probably mention that gdb needs
    to be run with commandline arguments since the program takes commandline arguments and then syntax
    for this is <strong>gdb --args filename arg1 arg2 arg3</strong>. Now, I've made a guess here,
    which is that since the output of the error message is <strong>sorry, <i>name</i>, you don't have a license</strong>,
    that the name is read once, and read by both the error code and success code, so i might be able to use
    this information to search for references to the memory location of the name. Now, since the name
    is the first commandline argument, it is probably read early in the program. Specifically I refer
    to the following code <strong><i>mov    QWORD PTR [rbp-0x10],rsi</i></strong>, I know that the rsi
    register is associated with strings, the si standing for <i>string index</i>, so I will try this 
    location to see if name is read with proximity to this instruction. <br>
    I'll put a breakpoint on that instruction, and run the program. I don't want too much output with
    <i>disas</i>, so I'll constraint it's output with <i>disas main,*main+20</i>, where main is the name
    of the function, and the amount of output is proportional to the size of the number, in this case 20.
      

    
    
    
     
  </p>
  
  
  </p>
  </body>
  </html>

<!DOCTYPE html>
<html>
<head>
<style>
  body {background-color: #121212;
        color: white;}
  h1 { text-align: center; }
  #code_1 { border: 2px solid white; width: 50%; margin: auto; padding: 2px;text-align: center;}
  #code_2 { border: 2px solid red; }
  .source { border: 2px solid white; width: 50%; margin: auto; padding: 4px; text-align: center;}
 


</style>
<body>
  <h1>4N0NY31TY's First Crackme</h1><br>
  <p>First things first, we run the program, and see that it takes only a single argument, the license key.
    The next thing I'll do is load it into a debugger <i>gdb</i> and check for any calls to <i>strmcp()</i>
    The program was much more complex than i was expecting, with calls to functions like <i>malloc()</i>,
    <i>realloc()</i>, and some user created functions. There were several calls to <i>printf()</i>
    and <i>puts()</i> so I decided to map these out by setting breakpoints. After the first call to
    <i>printf()</i>, nothing was printed, which was unexpected. After trying to override a cmp instruction,
    it resulted in a segmentation fault, so I opted instead to try to recover the arguments passed to the
    different functions. At this point I was confident that the license check routine was performed within
    the <i>input()</i> function.<br><br>
    <i>malloc()</i> took a single argument, a <i>size</i> argument, and I wanted to see if this varied
    based on the user input. The <i>malloc()</i> call occurred before the reading of the license key, so
    it must be hardcoded. I examined the memory of the address returned by <i>malloc()</i>, and much of it
    was zeros, while <i>malloc()</i> has been known to do this, as a sanity check I examined the heap section
    based on the info provided by <i><strong>info proc mappings</strong></i> within <i>gdb</i>
    I subtracted the addresses of the heap section provided by the memory map of the program with the following
    output.<br><br> 
    <p class="source">p 0x55555555a000-0x555555559000<br>
                        $35 = 4096
    </p><br>
    4096 was a nice number to see, as it seemed to be aligned to a page size. Next I wanted to see if the
  address returned by <i>malloc()</i> was inclusive to this range, and figured that the difference must be
  to the expression 0&gt;d&lt;4096. (Output listed below)
  <p class="source">p 0x55555555a000-0x5555555596b0<br>
                      $38 = 2384<br>
    </p><br>
    This confirmed that it was definitely within the heap section, and that this indeed was the address
  returned by <i>malloc()</i>
    </p>
  </body>
  </html>
